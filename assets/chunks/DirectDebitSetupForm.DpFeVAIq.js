import{_ as x,u as X,r as c,h as _,o as s,c as l,a as t,e as V,t as u,b as i,w as v,v as f,n as y,a5 as w,i as P}from"./framework.BIo0GyiP.js";const B={class:"direct-debit-setup-form"},I={class:"summary-section"},U={class:"summary-box"},q={class:"amount"},A={key:0},F={class:"type"},M={class:"form-group"},O={key:0,class:"error-message"},T={class:"form-group"},J={key:0,class:"error-message"},j={class:"form-group"},G={key:0,class:"error-message"},R={class:"form-group"},z={key:0,class:"error-message"},E={key:0,class:"form-group"},Y=["disabled"],H={__name:"DirectDebitSetupForm",setup(K){const g=X(),p=c(!1),d=c(null),k=c(null),a=c({accountName:"",sortCode:"",accountNumber:"",bankName:"",preferredPaymentDate:"1"}),o=c({});_(()=>{const r=localStorage.getItem("donationDetails"),e=localStorage.getItem("donorDetails");r&&(d.value=JSON.parse(r)),e&&(k.value=JSON.parse(e))});const h=r=>{const m=r.replace(/\D/g,"").match(/(\d{0,2})(\d{0,2})(\d{0,2})/);if(m){const b=m.slice(1).filter(Boolean).join("-");a.value.sortCode=b}},S=()=>(o.value={},a.value.accountName||(o.value.accountName="Account name is required"),(!a.value.sortCode||a.value.sortCode.length!==8)&&(o.value.sortCode="Valid sort code is required (XX-XX-XX)"),(!a.value.accountNumber||a.value.accountNumber.length!==8)&&(o.value.accountNumber="Valid 8-digit account number is required"),a.value.bankName||(o.value.bankName="Bank name is required"),Object.keys(o.value).length===0),C=async()=>{if(S()){p.value=!0;try{await new Promise(r=>setTimeout(r,1e3)),localStorage.setItem("directDebitDetails",JSON.stringify(a.value)),g.go("/donate/confirmation")}catch(r){console.error("Failed to setup Direct Debit:",r)}finally{p.value=!1}}};return(r,e)=>{var m,b,N,D;return s(),l("div",B,[t("div",I,[e[7]||(e[7]=t("h2",null,"Donation Summary",-1)),t("div",U,[t("p",q,[e[6]||(e[6]=t("span",{class:"label"},"Amount:",-1)),V(" £"+u(((m=d.value)==null?void 0:m.amount)||"0")+" ",1),((b=d.value)==null?void 0:b.type)==="monthly"?(s(),l("span",A,"/month")):i("",!0)]),t("p",F,u(((N=d.value)==null?void 0:N.type)==="monthly"?"Monthly donation":"One-time donation"),1)])]),t("form",{onSubmit:P(C,["prevent"]),class:"bank-details-form"},[e[14]||(e[14]=t("h2",null,"Bank Account Details",-1)),t("div",M,[e[8]||(e[8]=t("label",{for:"accountName"},"Name on Account",-1)),v(t("input",{type:"text",id:"accountName","onUpdate:modelValue":e[0]||(e[0]=n=>a.value.accountName=n),class:y({error:o.value.accountName})},null,2),[[f,a.value.accountName]]),o.value.accountName?(s(),l("span",O,u(o.value.accountName),1)):i("",!0)]),t("div",T,[e[9]||(e[9]=t("label",{for:"sortCode"},"Sort Code",-1)),v(t("input",{type:"text",id:"sortCode","onUpdate:modelValue":e[1]||(e[1]=n=>a.value.sortCode=n),onInput:e[2]||(e[2]=n=>h(n.target.value)),placeholder:"XX-XX-XX",maxlength:"8",class:y({error:o.value.sortCode})},null,34),[[f,a.value.sortCode]]),o.value.sortCode?(s(),l("span",J,u(o.value.sortCode),1)):i("",!0)]),t("div",j,[e[10]||(e[10]=t("label",{for:"accountNumber"},"Account Number",-1)),v(t("input",{type:"text",id:"accountNumber","onUpdate:modelValue":e[3]||(e[3]=n=>a.value.accountNumber=n),maxlength:"8",class:y({error:o.value.accountNumber})},null,2),[[f,a.value.accountNumber]]),o.value.accountNumber?(s(),l("span",G,u(o.value.accountNumber),1)):i("",!0)]),t("div",R,[e[11]||(e[11]=t("label",{for:"bankName"},"Bank Name",-1)),v(t("input",{type:"text",id:"bankName","onUpdate:modelValue":e[4]||(e[4]=n=>a.value.bankName=n),class:y({error:o.value.bankName})},null,2),[[f,a.value.bankName]]),o.value.bankName?(s(),l("span",z,u(o.value.bankName),1)):i("",!0)]),((D=d.value)==null?void 0:D.type)==="monthly"?(s(),l("div",E,[e[13]||(e[13]=t("label",{for:"preferredPaymentDate"},"Preferred Payment Date",-1)),v(t("select",{id:"preferredPaymentDate","onUpdate:modelValue":e[5]||(e[5]=n=>a.value.preferredPaymentDate=n)},e[12]||(e[12]=[t("option",{value:"1"},"1st of each month",-1),t("option",{value:"15"},"15th of each month",-1),t("option",{value:"28"},"28th of each month",-1)]),512),[[w,a.value.preferredPaymentDate]])])):i("",!0),e[15]||(e[15]=t("div",{class:"dd-guarantee"},[t("h3",null,"Direct Debit Guarantee"),t("ul",null,[t("li",null,"This Guarantee is offered by all banks and building societies that accept instructions to pay Direct Debits"),t("li",null,"If there are any changes to the amount, date or frequency of your Direct Debit, we will notify you 10 working days in advance"),t("li",null,"If an error is made in the payment of your Direct Debit, you are entitled to a full and immediate refund from your bank or building society"),t("li",null,"You can cancel a Direct Debit at any time by contacting your bank or building society")])],-1)),t("button",{type:"submit",disabled:p.value,class:"submit-button"},u(p.value?"Setting up...":"Set Up Direct Debit"),9,Y)],32),e[16]||(e[16]=t("div",{class:"back-link"},[t("a",{href:"/donate"},"← Return to Donation Form")],-1))])}}},Q=x(H,[["__scopeId","data-v-e2ec990e"]]);export{Q as default};
